---
import type { Post } from 'types/utils';
import TagHeading from './common/TagHeading.astro';
import { PostCardContainer, PostCardDetails } from '@components/postcard';
import { Link } from '@components/common/link';

const isAdmin = !!Astro.cookies.get('isAdmin');

const { relatedArticles } = Astro.props;
const blogs = relatedArticles.filter((entry: Post) =>
   isAdmin ? entry : !entry.data.is_private,
);
---

{
   relatedArticles.length > 0 && (
      <aside class="container-related-posts" aria-label="Related posts">
         <TagHeading
            classes="related-articles-heading"
            tag="h3"
            style="text-align: center; margin-bottom: 20px"
         >
            Art√≠culos Relacionados
         </TagHeading>
         {blogs.map((relatedArticle: Post) => (
            <PostCardContainer>
               <Link
                  href={`/blog/${relatedArticle.slug}`}
                  isFilled={false}
                  classes="post-link-wrapper"
                  text={relatedArticle.data.title}
               />
               <TagHeading tag="h4">
                  <Link
                     href={`/blog/${relatedArticle.slug}`}
                     isFilled={false}
                     classes="post-title"
                     text={relatedArticle.data.title}
                     data-normal-link
                  />
               </TagHeading>
               <PostCardDetails
                  author={relatedArticle.data.author}
                  date={relatedArticle.data.date as string}
               />
            </PostCardContainer>
         ))}
      </aside>
   )
}

<style is:inline>
   .container-related-posts {
      margin-top: 20px;
      & article {
         margin: 5px 0;
      }
   }
   .container-related-posts {
      & .post-card-details {
         gap: 0px;
         margin-left: auto;
         padding-left: 10px;
         .post-card-author {
            margin-right: 5px;
         }
      }
   }
</style>
